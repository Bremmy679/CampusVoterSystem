<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JKUSA Voting Page</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <link rel="stylesheet" href="../static/styles/voting_page.css">


</head>

<body>
    <!-- Header part -->
    <section>
        <div class="content-header">
            <div class="header-4">
                <h4>JKUSA</h4>
                <h4>{{votePost}}</h4>
            </div>
        </div>

    </section>
    <!-- End of header part -->
    <h5>{{votePost}}</h5>
    {% with messages = get_flashed_messages() %} {% if messages %} {% for message in messages %} {% if error %}
    <div class="alert alert-danger alert-dismissible d-flex align-items-center fade show">
        <i class="bi-exclamation-octagon-fill"></i>
        <strong class="mx-2">Error!</strong> {{error}}
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
    {% endif %} {% if msg %}
    <div class="alert alert-success alert-dismissible d-flex align-items-center fade show">
        <i class="bi-check-circle-fill"></i>
        <strong class="mx-2">Success!</strong> {{message}}
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>

    {% endif %} {% endfor %} {% endif %} {% endwith %}
    <div class="row">
        {% for candidate in candidates %}
        <div class="card">
            <form action="{{ url_for('process_vote', votePost=votePost) }}" method="post">

                <div class="form-check form-check-inline">
                    <label class="form-check-label" for="inlineRadio1">
                <div class="row-cols-2">
                    <div class="column-gap-0">
                        <img src="https://t4.ftcdn.net/jpg/00/97/58/97/240_F_97589769_t45CqXyzjz0KXwoBZT9PRaWGHRk5hQqQ.jpg" alt="Person 1" class="candidate-image" height="100px" width="100px" style="border-radius: 50%;">
                    </div>
                    <div class="col-md-4 " style="column-span: 2;">
                    <p class="candidate-name" id="{{candidate.name}}">{{candidate.name}}</p>
                    <p class="candidate-reg" id="candidate_reg_no_{{candidate.regNo}}">{{candidate.regNo}}</p>
                    <p class="candidate-course" id="candidatecourse">{{candidate.course}}</p>
                    <p>{{candidate.school}}</p>
                    <p>{{candidate.college}}</p>
                </div>
                
            </div>
            <input class="form-check-input" type="radio" id="inlineRadio{{ candidate.regNo }}" name="selected_candidate" value="{{ candidate.regNo }}" style="border-color: aqua;">
        </label>
                </div>
            </form>

        </div>
        {% endfor %}
    </div>
    <button type="submit" class="btn btn-primary">Vote</button>
</body>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Select the form and the submit button
        var form = document.querySelector('form');
        var submitButton = document.querySelector('.btn-primary');

        // Add a click event listener to the submit button
        submitButton.addEventListener('click', function(event) {
            // Prevent the default form submission
            event.preventDefault();

            // Select the checked radio button
            var selectedCandidate = document.querySelector('input[name="selected_candidate"]:checked');

            // Check if a radio button is selected
            if (selectedCandidate) {
                // Retrieve the value of the selected radio button
                var candId = selectedCandidate.value;

                // Add a hidden input to the form with the selected candidate ID
                var hiddenInput = document.createElement('input');
                hiddenInput.type = 'hidden';
                hiddenInput.name = 'selected_candidate';
                hiddenInput.value = candId;
                form.appendChild(hiddenInput);

                // Now you can submit the form
                form.submit();
            } else {
                // No radio button is selected, handle this case as needed
                console.log('Please select a candidate before submitting.');
            }
        });
    });
</script>

</html>